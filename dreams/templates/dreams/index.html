{% load static %}<!-- carrega static tags -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interpretar Sonho com DreamScribAI</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
    <div class="container">
        <h1>Interpretar Sonho com DreamScribAI</h1>
        <form id="dreamForm" method="post" action="{% url 'interpret_dream' %}">
            {% csrf_token %}
            <label for="dreamText">Descrição do Sonho:</label><br>
            <textarea id="dreamText" name="dream_text" rows="4" cols="50" required></textarea><br><br>

            <label for="healthStatus">Estado de Saúde:</label><br>
            <input type="text" id="healthStatus" name="health_status" required><br><br>

            <label for="relationshipStatus">Relações Pessoais:</label><br>
            <input type="text" id="relationshipStatus" name="relationship_status" required><br><br>

            <label for="feelingsDuring">Sentimentos Durante o Sonho:</label><br>
            <input type="text" id="feelingsDuring" name="feelings_during" required><br><br>

            <label for="feelingsAfter">Sentimentos Após Acordar:</label><br>
            <input type="text" id="feelingsAfter" name="feelings_after" required><br><br>

            <label for="dreamContext">Contexto do Sonho:</label><br>
            <input type="text" id="dreamContext" name="dream_context" required><br><br>

            <label for="dreamFrequency">Frequência do Sonho:</label><br>
            <input type="text" id="dreamFrequency" name="dream_frequency" required><br><br>

            <label for="cultureBeliefs">Cultura e Crenças:</label><br>
            <input type="text" id="cultureBeliefs" name="culture_and_beliefs" required><br><br>

            <label for="psychologicalState">Estado Psicológico:</label><br>
            <input type="text" id="psychologicalState" name="psychological_state" required><br><br>

            <button type="submit">Interpretar Sonho</button>
        </form>

        <div id="response" class="response">
            <!-- Aqui será exibido o retorno da OpenAI -->
        </div>
    </div>

    <script>
        document.getElementById('dreamForm').addEventListener('submit', function(event) {
            event.preventDefault();
            var form = event.target;
            var formData = new FormData(form);
            var xhr = new XMLHttpRequest();
            xhr.open('POST', form.action, true);
            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
            xhr.onload = function() {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    document.getElementById('response').innerText = response.result;
                } else {
                    document.getElementById('response').innerText = 'Erro ao interpretar o sonho.';
                }
            };
            xhr.send(formData);
        });
    </script>
</body>
</html>
